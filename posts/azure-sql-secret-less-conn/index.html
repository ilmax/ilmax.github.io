<!doctype html><html lang=en-us><head><title>Configure secret-less connection from App Services to Azure Sql via terraform // Massimiliano's Tech Chronicles</title><link rel="shortcut icon" href=/site/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/site/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/site/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/site/favicon-16x16.png><link rel=manifest href=/site/site.webmanifest><meta charset=utf-8><meta name=generator content="Hugo 0.110.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Massimiliano Donini"><meta name=description content><link rel=stylesheet href=/css/main.min.cdda4555892afe80e149565d48e4ff09319ebdbd7b121ad7910661daac049b82.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-QK96EXLDNF"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QK96EXLDNF",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ilmax.github.io/posts/azure-sql-secret-less-conn/cover.jpg"><meta name=twitter:title content="Configure secret-less connection from App Services to Azure Sql via terraform"><meta name=twitter:description content="It&rsquo;s been a while since we can connect App services to Azure Sql in a secret-less fashion, using managed service identity (MSI for brevity from now onwards).
The configuration is a bit more complicated than connecting to other Azure services e.g. Azure Storage Account because it involves running some queries on the Azure Sql database in order to create the user and grant them the required privileges, for more info see the tutorial here."><meta property="og:title" content="Configure secret-less connection from App Services to Azure Sql via terraform"><meta property="og:description" content="It&rsquo;s been a while since we can connect App services to Azure Sql in a secret-less fashion, using managed service identity (MSI for brevity from now onwards).
The configuration is a bit more complicated than connecting to other Azure services e.g. Azure Storage Account because it involves running some queries on the Azure Sql database in order to create the user and grant them the required privileges, for more info see the tutorial here."><meta property="og:type" content="article"><meta property="og:url" content="https://ilmax.github.io/posts/azure-sql-secret-less-conn/"><meta property="og:image" content="https://ilmax.github.io/posts/azure-sql-secret-less-conn/cover.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-16T18:17:46+00:00"><meta property="article:modified_time" content="2022-02-16T18:17:46+00:00"></head><body><header class=app-header><a href=https://ilmax.github.io><img class=app-header-avatar src=/avatar.jpg alt="Massimiliano Donini"></a>
<span class=app-header-title>Massimiliano's Tech Chronicles</span><p>My adventures in Tech</p><nav class=app-header-menu><a class=app-header-menu-item href=/>Home</a>
|
<a class=app-header-menu-item href=/about/>About</a>
|
<a class=app-header-menu-item href=/tags/>Tags</a></nav><div class=app-header-social><a href=https://github.com/ilmax target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://twitter.com/maxx_don target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter"><title>Twitter</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://www.linkedin.com/in/massimiliano-donini/ target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin"><title>LinkedIn</title><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><p><img class=post-header-image src=/cover.jpg alt="Configure secret-less connection from App Services to Azure Sql via terraform"><br></p><h1 class=post-title>Configure secret-less connection from App Services to Azure Sql via terraform</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Feb 16, 2022</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>5 min read</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://ilmax.github.io/tags/azure/>azure</a>
<a class=tag href=https://ilmax.github.io/tags/terraform/>terraform</a>
<a class=tag href=https://ilmax.github.io/tags/sql/>sql</a>
<a class=tag href=https://ilmax.github.io/tags/managed-identity/>managed-identity</a></div></div></header><div class=post-content><p>It&rsquo;s been a while since we can connect App services to Azure Sql in a secret-less fashion, using <a href=https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview>managed service identity</a> (MSI for brevity from now onwards).</p><p>The configuration is a bit more complicated than connecting to other Azure services e.g. Azure Storage Account because it involves running some queries on the Azure Sql database in order to create the user and grant them the required privileges, for more info see the tutorial <a href="https://docs.microsoft.com/en-us/azure/app-service/tutorial-connect-msi-sql-database?tabs=windowsclient%2Cdotnet">here</a>.</p><p>In order to be able to connect to Azure Sql with MSI we need to configure few things:</p><ul><li>Grant database access to Azure AD users</li><li>Turn on MSI on the App Service</li><li>Create a user for the service principal and grant the required privileges in the database(s)</li><li>Change the connection string to use the new authentication mode</li></ul><p>This is quite easy to do manually, but if you are using IaC, then manual changes are a no go.</p><p>Configure all of this in terraform was a non trivial task and took me quite a bit to understand the ins and outs and since I wasn&rsquo;t able to find much documentation online, I decided to put together this blog post.</p><h2 id=step-1-grant-database-access-to-azure-ad-users>Step 1: Grant database access to Azure AD users</h2><p>In order to be able to connect to Azure Sql with a managed identity, we need to configure the Azure Sql Server to allow Azure AD authentication, you can read more on the subject <a href="https://docs.microsoft.com/en-us/azure/azure-sql/database/authentication-aad-configure?tabs=azure-powershell#provision-an-azure-active-directory-administrator-for-your-azure-sql-database-server">here</a>.</p><p>Via terraform we can configure it adding the <code>azuread_administrator</code> block on the Azure Sql Server resource as shown below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;azurerm_mssql_server&#34; &#34;sql&#34;</span> {
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>azuread_administrator</span> {
</span></span><span style=display:flex><span>    login_username <span style=color:#f92672>=</span> <span style=color:#66d9ef>var</span>.<span style=color:#66d9ef>sql_server_ad_admin_username</span>
</span></span><span style=display:flex><span>    object_id      <span style=color:#f92672>=</span> <span style=color:#66d9ef>var</span>.<span style=color:#66d9ef>sql_server_ad_admin_object_id</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here we&rsquo;re passing in the <strong>user name</strong> and the <strong>object id</strong> of the Azure AD User or Azure AD Group that we want to configure as the server admin.</p><h2 id=step-2-turn-on-msi-on-the-app-service>Step 2: Turn on MSI on the App Service</h2><p>In order to create a MSI for our App Service, we need to configure the identity block to <code>SytemAssigned</code> as shown below.</p><p>Please note that there&rsquo;s a small catch in terraform about turning on managed identity for an existing App Service, essentially you can&rsquo;t use it until it&rsquo;s there, so you may need to run <code>terraform apply</code> twice, one to turn on MSI, and then the second time to grant some privileges to it.</p><p>You can find more details on an issue I opened in the <strong>azurerm</strong> terraform provider <a href=https://github.com/hashicorp/terraform-provider-azurerm/issues/14139>here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;azurerm_app_service&#34; &#34;web&#34;</span> {
</span></span><span style=display:flex><span>  name                <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;${var.prefix}-web-backend-${var.env}&#34;</span>
</span></span><span style=display:flex><span>  location            <span style=color:#f92672>=</span> <span style=color:#66d9ef>azurerm_resource_group</span>.<span style=color:#66d9ef>backend</span>.<span style=color:#66d9ef>location</span>
</span></span><span style=display:flex><span>  resource_group_name <span style=color:#f92672>=</span> <span style=color:#66d9ef>azurerm_resource_group</span>.<span style=color:#66d9ef>backend</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>identity</span> {
</span></span><span style=display:flex><span>    type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SystemAssigned&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=step-3-create-a-user-for-the-service-principal-and-grant-the-required-privileges-in-the-databases>Step 3: Create a user for the service principal and grant the required privileges in the database(s)</h2><p>This is the tricky part, that I struggled to automate because it requires running a couple of sql commands in the Sql Server database, as suggested in this article <a href=https://techcommunity.microsoft.com/t5/azure-database-support-blog/using-managed-service-identity-msi-to-authenticate-on-azure-sql/ba-p/1288248>here</a>.</p><p>The sql you need to run creates a user and grants it the required privileges as shown below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> [ServicePrincipalName] <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>EXTERNAL</span> PROVIDER;
</span></span><span style=display:flex><span><span style=color:#66d9ef>GO</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>ROLE</span> db_datareader <span style=color:#66d9ef>ADD</span> MEMBER [ServicePrincipalName];
</span></span><span style=display:flex><span><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>ROLE</span> db_datawriter <span style=color:#66d9ef>ADD</span> MEMBER [ServicePrincipalName];
</span></span></code></pre></div><p>The point of this article though is to take care of this via terraform, in order to do so we need to:</p><ol><li>Get the current Azure tenant id</li><li>Read the App Service service principal from Azure AD</li><li>Create the user and grant it required privileges in the database</li></ol><p>Let&rsquo;s see how we can achieve this with terraform:</p><h3 id=get-current-tenant-id>Get current tenant id</h3><p>This is easy, we can use a built-in terraform data source to access it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#e6db74>&#34;azurerm_client_config&#34; &#34;current&#34;</span> {}
</span></span></code></pre></div><h3 id=read-the-app-service-service-principal-from-azure-ad>Read the App Service service principal from Azure AD</h3><p>Here we can once again use a terraform data source to get access to the <code>application_id</code> property of the generated MSI as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#e6db74>&#34;azuread_service_principal&#34; &#34;web_managed_identity&#34;</span> {
</span></span><span style=display:flex><span>  object_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>azurerm_app_service</span>.<span style=color:#66d9ef>web</span>.<span style=color:#66d9ef>identity</span>.<span style=color:#ae81ff>0</span>.<span style=color:#66d9ef>principal_id</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=create-the-user-and-grant-it-required-privileges>Create the user and grant it required privileges</h3><p>In order to achieve this step, we need to use a 3rd party provider called <code>mssql_user</code>, you can find it on the terraform registry <a href=https://registry.terraform.io/providers/betr-io/mssql/latest/docs/resources/user>here</a></p><p>The only catch here is that you need to specify an Azure AD credential to connect to the Azure Sql database, so you can use the user we configured in the step 1 above.
If you used an Azure AD group instead you may create a service principal, add it to the group in Azure AD and use it&rsquo;s <strong>client_id/client_secret</strong> to connect to the database.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;mssql_user&#34; &#34;web&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    host <span style=color:#f92672>=</span> <span style=color:#66d9ef>azurerm_mssql_server</span>.<span style=color:#66d9ef>sql</span>.<span style=color:#66d9ef>fully_qualified_domain_name</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>azure_login</span> {
</span></span><span style=display:flex><span>      tenant_id     <span style=color:#f92672>=</span> <span style=color:#66d9ef>data</span>.<span style=color:#66d9ef>azurerm_client_config</span>.<span style=color:#66d9ef>current</span>.<span style=color:#66d9ef>tenant_id</span>
</span></span><span style=display:flex><span>      client_id     <span style=color:#f92672>=</span> <span style=color:#66d9ef>var</span>.<span style=color:#66d9ef>sql_sp_client_id</span>
</span></span><span style=display:flex><span>      client_secret <span style=color:#f92672>=</span> <span style=color:#66d9ef>var</span>.<span style=color:#66d9ef>sql_sp_client_secret</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  object_id <span style=color:#f92672>=</span> <span style=color:#66d9ef>data</span>.<span style=color:#66d9ef>azuread_service_principal</span>.<span style=color:#66d9ef>web_managed_identity</span>.<span style=color:#66d9ef>application_id</span>
</span></span><span style=display:flex><span>  database  <span style=color:#f92672>=</span> <span style=color:#66d9ef>var</span>.<span style=color:#66d9ef>database_name</span>
</span></span><span style=display:flex><span>  username  <span style=color:#f92672>=</span> <span style=color:#66d9ef>azurerm_app_service</span>.<span style=color:#66d9ef>web</span>.<span style=color:#66d9ef>name</span>
</span></span><span style=display:flex><span>  roles     <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;db_datareader&#34;, &#34;db_datawriter&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Here we need to specify few things:</p><ul><li>The FQDN name of the Azure Sql Server</li><li>How to login to the database (I&rsquo;m using a service principal that&rsquo;s been added to the Azure AD group that&rsquo;s set as the Azure Sql Admin)</li><li>What&rsquo;s the object id of the service principal we are granting access to</li><li>What&rsquo;s the name of the service principal</li><li>What roles we want to assign to it</li></ul><h2 id=step-4-change-the-connection-string-to-use-the-new-authentication-mode>Step 4: Change the connection string to use the new authentication mode</h2><blockquote><p>Note that you need to reference System.Data.SqlClient version 3 or greater for dotnet core, older versions doesn&rsquo;t support <code>Authentication=Active Directory Default</code></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>locals</span> {
</span></span><span style=display:flex><span>  connection_string <span style=color:#f92672>=</span> &#34;Server<span style=color:#f92672>=</span>${var.prefix}-sql-${var.env}.database.windows.net; Authentication<span style=color:#f92672>=</span>Active Directory Default; Database<span style=color:#f92672>=</span>${var.database_name};MultipleActiveResultSets<span style=color:#f92672>=</span>False;Encrypt<span style=color:#f92672>=</span>True;TrustServerCertificate<span style=color:#f92672>=</span>False;Connection Timeout<span style=color:#f92672>=</span>30;Persist Security Info<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span><span style=color:#960050;background-color:#1e0010>;&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and then we just need to set this new connection string on the App Service as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;azurerm_app_service&#34; &#34;web&#34;</span> {
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  app_settings <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    &#34;ConnectionStrings__Database&#34; <span style=color:#f92672>=</span> <span style=color:#66d9ef>local</span>.<span style=color:#66d9ef>connection_string</span>
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As a last step, I&rsquo;m showing the terraform configuration to include all the required providers used to achieve this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>terraform</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>required_providers</span> {
</span></span><span style=display:flex><span>    azurerm <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      source  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;hashicorp/azurerm&#34;</span>
</span></span><span style=display:flex><span>      version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;~&gt; 2.84&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    azuread <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      source  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;hashicorp/azuread&#34;</span>
</span></span><span style=display:flex><span>      version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;~&gt; 2.14.0&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    mssql <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>      source  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;betr-io/mssql&#34;</span>
</span></span><span style=display:flex><span>      version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.2.4&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Nothing else needs to change in your code, given you were reading the connection string from the configuration.</p><p>I hope you find this useful!</p></div><div class=post-footer><style>.resp-sharing-button__link,.resp-sharing-button__icon{display:inline-block}.resp-sharing-button__link{text-decoration:none;color:#fff!important;margin:.2em}.resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-sharing-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:middle}.resp-sharing-button--small svg{margin:0;vertical-align:middle}.resp-sharing-button__icon{stroke:#fff;fill:none}.resp-sharing-button__icon--solid,.resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.resp-sharing-button--twitter{background-color:#55acee}.resp-sharing-button--twitter:hover{background-color:#2795e9}.resp-sharing-button--pinterest{background-color:#bd081c}.resp-sharing-button--pinterest:hover{background-color:#8c0615}.resp-sharing-button--facebook{background-color:#3b5998}.resp-sharing-button--facebook:hover{background-color:#2d4373}.resp-sharing-button--tumblr{background-color:#35465c}.resp-sharing-button--tumblr:hover{background-color:#222d3c}.resp-sharing-button--reddit{background-color:#ff4500}.resp-sharing-button--reddit:hover{background-color:#3a80c1}.resp-sharing-button--google{background-color:#dd4b39}.resp-sharing-button--google:hover{background-color:#c23321}.resp-sharing-button--linkedin{background-color:#0077b5}.resp-sharing-button--linkedin:hover{background-color:#046293}.resp-sharing-button--email{background-color:#777}.resp-sharing-button--email:hover{background-color:#5e5e5e}.resp-sharing-button--xing{background-color:#1a7576}.resp-sharing-button--xing:hover{background-color:#114c4c}.resp-sharing-button--whatsapp{background-color:#25d366}.resp-sharing-button--whatsapp:hover{background-color:#1da851}.resp-sharing-button--hackernews{background-color:#f60}.resp-sharing-button--hackernews:hover,.resp-sharing-button--hackernews:focus{background-color:#fb6200}.resp-sharing-button--vk{background-color:#507299}.resp-sharing-button--vk:hover{background-color:#43648c}.resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.resp-sharing-button--facebook:hover,.resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.resp-sharing-button--twitter:hover,.resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.resp-sharing-button--tumblr{background-color:#35465c;border-color:#35465c}.resp-sharing-button--tumblr:hover,.resp-sharing-button--tumblr:active{background-color:#222d3c;border-color:#222d3c}.resp-sharing-button--email{background-color:#777;border-color:#777}.resp-sharing-button--email:hover,.resp-sharing-button--email:active{background-color:#5e5e5e;border-color:#5e5e5e}.resp-sharing-button--pinterest{background-color:#bd081c;border-color:#bd081c}.resp-sharing-button--pinterest:hover,.resp-sharing-button--pinterest:active{background-color:#8c0615;border-color:#8c0615}.resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.resp-sharing-button--linkedin:hover,.resp-sharing-button--linkedin:active{background-color:#046293;border-color:#046293}.resp-sharing-button--reddit{background-color:#ff4500;border-color:#ff4500}.resp-sharing-button--reddit:hover,.resp-sharing-button--reddit:active{background-color:#ff5700;border-color:#ff5700}.resp-sharing-button--xing{background-color:#1a7576;border-color:#1a7576}.resp-sharing-button--xing:hover .resp-sharing-button--xing:active{background-color:#114c4c;border-color:#114c4c}.resp-sharing-button--whatsapp{background-color:#25d366;border-color:#25d366}.resp-sharing-button--whatsapp:hover,.resp-sharing-button--whatsapp:active{background-color:#1da851;border-color:#1da851}.resp-sharing-button--hackernews{background-color:#f60;border-color:#f60}.resp-sharing-button--hackernews:hover .resp-sharing-button--hackernews:active{background-color:#fb6200;border-color:#fb6200}.resp-sharing-button--vk{background-color:#507299;border-color:#507299}.resp-sharing-button--vk:hover .resp-sharing-button--vk:active{background-color:#43648c;border-color:#43648c}.resp-sharing-button--telegram{background-color:#54a9eb}.resp-sharing-button--telegram:hover{background-color:#4b97d1}</style><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https://ilmax.github.io/posts/azure-sql-secret-less-conn/" target=_blank rel=noopener aria-label title=Facebook><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Configure%20secret-less%20connection%20from%20App%20Services%20to%20Azure%20Sql%20via%20terraform&url=https://ilmax.github.io/posts/azure-sql-secret-less-conn/" target=_blank rel=noopener aria-label title=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Configure%20secret-less%20connection%20from%20App%20Services%20to%20Azure%20Sql%20via%20terraform&body=https://ilmax.github.io/posts/azure-sql-secret-less-conn/" target=_self rel=noopener aria-label title=E-Mail><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https://ilmax.github.io/posts/azure-sql-secret-less-conn/&resubmit=true&title=Configure%20secret-less%20connection%20from%20App%20Services%20to%20Azure%20Sql%20via%20terraform" target=_blank rel=noopener aria-label title=Reddit><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div></div></a><script src=https://giscus.app/client.js data-repo=ilmax/site data-repo-id=R_kgDOIvGqCw data-category="Post Comments" data-category-id=DIC_kwDOIvGqC84CTeD0 data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=dark_dimmed data-lang=en data-loading=lazy crossorigin=anonymous async></script></div></article></main></body></html>